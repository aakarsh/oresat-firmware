/**
 * @file    ax25.c
 * @brief   AX.25 protocol support library.
 *
 * @addtogroup AX25
 * @{
 */
#include <string.h>
#include "ax25.h"

/*===========================================================================*/
/* Local definitions.                                                        */
/*===========================================================================*/

/*===========================================================================*/
/* Exported variables.                                                       */
/*===========================================================================*/

/*===========================================================================*/
/* Local variables and types.                                                */
/*===========================================================================*/

/*===========================================================================*/
/* Local functions.                                                          */
/*===========================================================================*/

/*===========================================================================*/
/* Interface implementation.                                                 */
/*===========================================================================*/

/*===========================================================================*/
/* Exported functions.                                                       */
/*===========================================================================*/

void ax25_send(pdu_t *pdu, void *arg)
{
    ax25_frame_t frame;
    const ax25_link_t *link = arg;

    for (int i = 0; i < 6; i++) {
        frame.dest[i] = link->dest[i] << 1;
        frame.src[i] = link->src[i] << 1;
    }
    frame.dest_ssid = AX25_SSID(link->dest_ssid);
    frame.src_ssid = AX25_SSID(link->src_ssid) | AX25_SSID_EXT;
    frame.control = link->control;
    pdu->mac_hdr = &frame;
    if (link->phy_send) {
        link->phy_send(pdu, 0, link->phy_arg);
    }
}

/** @} */
